\documentclass[../report.tex]{subfiles}
\begin{document}

\chapter{Esempi}\label{c:esempi}
Nelle seguenti sezioni sono riportati alcuni dei 27 esempi che sono stati utilizzati per accertarsi che il compilatore e l'interprete del linguaggio \textbf{SimpLanPlus} rispettasse le specifiche richieste.
\section{Esempio 1}
\begin{lstlisting}
{
    ^^int x;
    ^int y = new int;
    y^ = 1;
    x = new ^int;
    x^ = y;
    print x^^;
}
\end{lstlisting}
L'esempio presente nel file \verb|examples/example1.simplan| mostra il corretto uso dei puntatori.
Vengono creati due puntatori, \verb|x| che punta a sua volta a un puntatore di interi e \verb|y| che punta a un intero.
Le aree di memoria puntate dai puntatori vengono scritte e ciÃ² viene verificato stampando il valore intero puntato dal puntatore puntato da \verb|x|.

\section{Esempio 2}
\begin{lstlisting}
{
    ^int x = new int;
    x^ = 1;
    delete x;
    y = x^; // this is wrong!
}
\end{lstlisting}
L'esempio presente nel file \verb|examples/example2.simplan| mostra il riconoscimento dell'utilizzo di un identificatore mai dichiarato.
L'assegnazione del valore \verb|x^| alla variabile \verb|y| mai dichiarata viene riconosciuta come errore semantico e correttamente riportata con un avviso \verb|Missing declaration for ID: y|.
Inoltre, tramite l'analisi degli effetti, il compilatore riconosce che la variabile \verb|x| viene usata dopo essere stata cancellata mostrando all'utente il messaggio \verb|Variable x is used after deletion|.

\section{Esempio 3}
\begin{lstlisting}
{
    ^int x = new int;
    void f(^int x, ^int y) {
        delete x;
        delete y;
    }

    f(x,x);
}
\end{lstlisting}
L'esempio presente nel file \verb|examples/example3.simplan| mostra il riconoscimento del problema dell'aliasing. La funzione \verb|void f(^int x, ^int y)| prende in input due puntatori e li elimina. Quando la funzione viene invocata passandole lo stesso puntatore due volte \verb|f(x, x)| il compilatore riconosce, correttamente, che il puntatore \verb|x| verrebbe eliminato due volte e lo comunica all'utente tramite il messaggio \verb|Variable x is used after deletion|.

\section{Esempio 8}
\begin{lstlisting}
{
    void f(int m, int n) {
        if (m>n) {
            print(m+n);
        }
        else {
            int x = 1;
            f(m+1,n+1);
        }
    }
    f(5,4);
}
\end{lstlisting}
L'esempio presente nel file \verb|examples/example8.simplan| mostra il corretto funzionamento di una chiamata ricorsiva. In caso si invertissero i parametri della chiamata, passando da \verb|f(5, 4)| a \verb|f(4, 5)|, questa funzione, correttamente, non potrebbe terminare. Essendo la memoria dell'interprete finita, prima o poi, verrebbe mostrato il messaggio di errore \verb|Error: Reached max memory limit|.
\end{document}

